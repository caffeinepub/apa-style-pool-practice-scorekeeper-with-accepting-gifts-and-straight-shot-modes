{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 3,
  "summary": "Fix Match History Table “All” view to compute W-L/Win% running totals per-mode (ignoring unknown outcomes) and restore the missing toggleable “Sort by date” behavior using existing effective timestamp logic, without changing default ordering or UI layout.",
  "architectural_notes": [
    "Per-row W-L/Win% in “All” view must be computed as a per-mode running total in the current displayed sort order; other modes never contribute even if interleaved.",
    "Use existing getEffectiveMatchTimestamp(match) for date sorting; do not add new timestamp helpers; do not parse notes for outcome—use existing matchWinLoss.ts."
  ],
  "known_issues": [
    "BUG: In Match History Table “All” view, W-L and Win% accumulate across mode boundaries instead of per-mode.",
    "Missing regression: “Sort by date” behavior is not working in Match History Table."
  ],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-fix-matchhistorytable-running-w-l-and-win-so-each-row-s-displayed-w-l-win-is-computed-only-from-matches-of-the-same-mode-bucket-as-that-row-official-apa-apa-practice-accepting-gifts-straight-shot-using-the-current-displayed-sort-order-and-counting-from-the-start-of-that-mode-s-sequence-up-through-the-current-row-i-e-running-within-mode-regardless-of-adjacency",
      "title": "Fix MatchHistoryTable running W-L and Win% so each row’s displayed W-L/Win% is computed only from matches of the same mode/bucket as that row (Official APA, APA Practice, Accepting Gifts, Straight Shot), using the current displayed sort order and counting from the start of that mode’s sequence up through the current row (i.e., running within mode regardless of adjacency).",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-restore-the-missing-toggleable-sort-by-date-behavior-in-matchhistorytable-using-the-existing-geteffectivematchtimestamp-match-comparator-without-changing-the-default-ordering-behavior-that-exists-today-sorting-must-only-change-when-the-user-uses-the-table-s-existing-sort-ui-control-do-not-add-new-controls",
      "title": "Restore the missing toggleable “Sort by date” behavior in MatchHistoryTable using the existing getEffectiveMatchTimestamp(match) comparator, without changing the default ordering behavior that exists today; sorting must only change when the user uses the table’s existing sort UI control (do not add new controls).",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-keep-matchhistorytable-ui-layout-columns-and-date-display-unchanged-while-implementing-the-logic-fixes-limiting-changes-to-frontend-src-components-history-matchhistorytable-tsx-plus-any-already-existing-sort-control-wiring-required",
      "title": "Keep MatchHistoryTable UI layout/columns and date display unchanged while implementing the logic fixes, limiting changes to frontend/src/components/history/MatchHistoryTable.tsx (plus any already-existing sort control wiring required).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Fix Match History Table “All” view W-L/Win% running totals to be computed per-mode (running within mode in current sort order) and exclude unknown outcomes from wins/losses and Win% denominator; no layout/column changes; MatchHistoryTable.tsx only.",
      "reqIds": [],
      "status": "in_progress"
    },
    {
      "id": "AR-2",
      "summary": "Restore/implement missing toggleable “Sort by date” in Match History Table using existing getEffectiveMatchTimestamp(match); apply only via existing UI control; do not change default ordering or add new controls; keep date display date-only.",
      "reqIds": [],
      "status": "in_progress"
    }
  ],
  "projectName": "Match History",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}