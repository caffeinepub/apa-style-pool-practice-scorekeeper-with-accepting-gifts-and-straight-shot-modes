{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 3,
  "summary": "Surgical updates to Match History/Matchups table logic only (no layout changes): reuse existing match-type discriminator, display aPPI only for Official APA rows, and unify sorting via existing effective timestamp logic.",
  "architectural_notes": [
    "No layout changes; surgical table logic updates only.",
    "Do not introduce new flags/fields for match type; reuse existing match-type/mode discriminator used in matchWinLoss.ts/history row model/match builders.",
    "For unified sorting, use existing getEffectiveMatchTimestamp(match) (no new helper).",
    "Keep Date display formatting exactly as-is (date-only), even though sorting uses timestamps for drills."
  ],
  "known_issues": [],
  "isFixRequest": true,
  "existing_features": [
    {
      "id": "feature-identify-official-apa-match-rows-using-the-existing-match-type-mode-discriminator-already-used-elsewhere-in-the-codebase-same-mechanism-as-in-frontend-src-lib-history-matchwinloss-ts-frontend-src-lib-history-matchhistoryrowmodel-ts-and-the-match-builders-do-not-add-any-new-flags-fields",
      "title": "Identify “Official APA match” rows using the existing match-type/mode discriminator already used elsewhere in the codebase (same mechanism as in frontend/src/lib/history/matchWinLoss.ts, frontend/src/lib/history/matchHistoryRowModel.ts, and the match builders). Do not add any new flags/fields.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-match-history-table-appi-display-so-that-appi-is-displayed-for-official-apa-rows-only-using-the-existing-official-apa-appi-computation-utility-with-full-context-and-show-for-official-apa-rows-where-appi-cannot-be-computed-due-to-missing-inputs-for-all-non-official-rows-apa-practice-accepting-gifts-straight-shot-always-display-in-the-appi-column",
      "title": "Fix Match History table aPPI display so that aPPI is displayed for Official APA rows only, using the existing official APA aPPI computation utility (with full context), and show \"—\" for Official APA rows where aPPI cannot be computed due to missing inputs. For all non-Official rows (APA Practice / Accepting Gifts / Straight Shot), always display \"—\" in the aPPI column.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-match-history-all-history-ordering-uses-one-unified-sort-key-sort-strictly-by-the-numeric-value-returned-by-the-existing-geteffectivematchtimestamp-match-no-new-helper-newest-first-keep-the-date-display-exactly-as-it-is-now-date-only",
      "title": "Ensure the Match History “All History” ordering uses one unified sort key: sort strictly by the numeric value returned by the existing getEffectiveMatchTimestamp(match) (no new helper), newest first. Keep the Date display exactly as it is now (date-only).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Use existing Official APA vs APA Practice discriminator (no new flags/fields) for table logic and logging behavior",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Fix aPPI display: show aPPI only for Official APA rows using existing computation util; show — when missing inputs",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Fix All History sorting: use existing getEffectiveMatchTimestamp(match) numeric value so Official APA sorts by user-entered match date and drills by high-resolution timestamp; keep date display unchanged",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "projectName": "Match History",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}