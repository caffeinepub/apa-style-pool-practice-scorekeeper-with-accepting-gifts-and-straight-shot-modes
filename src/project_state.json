{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 35,
  "summary": "APA pool practice scorekeeper app (APA 9-ball Equalizer) with per-rack ball/dead-ball tracking, defensive shots, innings, PPI, match-point conversion, and additional practice modes (Accepting Gifts, Straight Shot); plus a discrete 4th mode to log real/official APA matches and chart both actual PPI and adjusted PPI (each with best-10-of-last-20 rolling line). Invite-only access control/login approval is deprioritized/optionally disabled for now to ship a working version.",
  "architectural_notes": [
    "Straight Shot is a drill scored by total strokes/shots (goal: 20 or under) with mode-specific stats including scratches (+2) and a moving average across sessions; ensure UI copy avoids calling it 'straight pool'.",
    "APA mode must be APA 9-ball (Equalizer points), not an 8-ball-style race; remove/avoid any 'race to X' concepts in UI and logic.",
    "APA 9-ball session tracking should support rack-by-rack 10-point accounting: player A points + player B points + dead balls = 10 each rack; include 9-ball worth 2, dead balls worth 0, and support defensive shots + innings for correct PPI.",
    "APA 9-ball rules constraints to encode: no push-outs (standard handicapped APA 9-ball), 9-on-the-snap ends rack with 2 points, three consecutive fouls within a rack loses the rack and remaining balls become dead.",
    "APA 9-ball active scoring UI should mirror official APA scorekeeper flow: per-rack display of balls 1–9, tap-to-select pocketed balls for the current inning, Turn Over control to switch players, innings auto-increment logic, and in-flow toggles/controls to mark dead balls and defensive shots.",
    "APA 9-ball practice rule: when the 9-ball is pocketed early (ends the rack), all remaining balls in that rack should be marked dead (0 points) to preserve 10-point rack accounting.",
    "Accepting Gifts progression: user wants minimum object balls = 2 (not 1) and the starting ball count for a new session should default to the last saved/current count from the prior session; also provide a manual reset/override to any allowed count (e.g., jump to 7).",
    "Introduce a per-device/account \"Primary Player\" concept so the app recognizes the main user across matches while still allowing ad-hoc opponent names.",
    "Results UX: keep individual match view; add navigation/button to a per-player Aggregate Stats view with graphs computed from that player name across saved matches.",
    "Privacy/team rollout: implement optional invite-only access control for Internet Identity by maintaining an allowlist of approved principals plus a pending-requests list for owner approval (Approve/Reject + 'Reject All Pending'); non-approved users are blocked; plan for a future toggle to disable this for public release."
  ],
  "known_issues": [
    "User reports login/session state was lost (had to redo login). Investigate persistence/auth regression causing logout or lost saved credentials.",
    "Bug: entering the Primary Player name into Player 2 does not update the skill level on the match page; also possible to start a match with the Primary Player name in both Player 1 and Player 2 (should be blocked).",
    "App can get stuck on the “Checking access…” loading screen during access-control checks; needs a fail-open/disable option or clear error/timeout so the app remains usable."
  ],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-create-the-core-app-navigation-and-information-architecture-for-a-pool-scorekeeper-app-with-three-modes-1-apa-style-practice-scorekeeping-similar-to-the-official-apa-scorekeeper-app-2-accepting-gifts-and-3-straight-shot",
      "title": "Create the core app navigation and information architecture for a pool scorekeeper app with three modes: (1) APA-style practice scorekeeping similar to the official APA Scorekeeper app, (2) Accepting Gifts, and (3) Straight Shot.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-build-an-apa-style-practice-scorekeeping-flow-ui-data-capture-that-lets-a-user-track-a-practice-match-in-a-way-that-is-recognizable-and-usable-as-an-apa-style-scorekeeper-for-practice-including-at-minimum-players-race-target-or-equivalent-match-goal-current-score-and-per-visit-inning-events-entry",
      "title": "Build an APA-style practice scorekeeping flow (UI + data capture) that lets a user track a practice match in a way that is recognizable and usable as an APA-style scorekeeper for practice, including at minimum: players, race/target (or equivalent match goal), current score, and per-visit/inning events entry.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-accepting-gifts-mode-with-end-to-end-creation-in-progress-tracking-and-completion-saving-include-a-dedicated-screen-to-display-the-accepting-gifts-rules-and-scoring-method-and-implement-the-scoring-logic-according-to-the-user-provided-rules",
      "title": "Add an Accepting Gifts mode with end-to-end creation, in-progress tracking, and completion saving; include a dedicated screen to display the Accepting Gifts rules and scoring method, and implement the scoring logic according to the user-provided rules.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-straight-shot-mode-with-end-to-end-creation-in-progress-tracking-and-completion-saving-implement-the-scoring-inputs-and-summary-appropriate-for-a-straight-shot-practice-game-e-g-attempts-makes-streaks-or-other-metrics-with-exact-tracked-fields-configurable-based-on-user-clarification",
      "title": "Add a Straight Shot mode with end-to-end creation, in-progress tracking, and completion saving; implement the scoring inputs and summary appropriate for a Straight Shot practice game (e.g., attempts, makes, streaks, or other metrics), with exact tracked fields configurable based on user clarification.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-match-history-ui-that-filters-by-mode-apa-practice-accepting-gifts-straight-shot-and-shows-a-compact-summary-card-per-game-date-players-final-result-summary",
      "title": "Add a Match History UI that filters by mode (APA Practice / Accepting Gifts / Straight Shot) and shows a compact summary card per game (date, players, final result/summary).",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-apply-a-cohesive-visual-theme-and-component-styling-across-the-app-typography-spacing-button-styles-cards-and-headers-suitable-for-a-pool-practice-utility-avoid-a-blue-purple-primary-palette-unless-explicitly-requested-later",
      "title": "Apply a cohesive visual theme and component styling across the app (typography, spacing, button styles, cards, and headers) suitable for a pool practice utility; avoid a blue/purple primary palette unless explicitly requested later.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-straight-shot-mode-copy-and-naming-so-it-does-not-imply-the-game-is-straight-pool-ensure-all-user-facing-text-refers-to-it-as-a-stroke-counting-drill-and-describes-the-correct-drill-rules-in-english",
      "title": "Update the Straight Shot mode copy and naming so it does not imply the game is \"straight pool\"; ensure all user-facing text refers to it as a stroke-counting drill and describes the correct drill rules in English.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-straight-shot-strokes-drill-rule-tracking-in-the-active-straight-shot-session-count-strokes-shots-apply-win-condition-of-20-strokes-shots-or-under-require-pocketing-all-balls-with-the-8-ball-last-rules-display-session-completion-apply-scratch-penalty-as-2-shots-and-ensure-the-break-shot-does-not-count-as-a-shot-explicitly-handle-and-document-the-scratch-on-break-case-per-the-user-note",
      "title": "Implement Straight Shot (strokes drill) rule tracking in the active Straight Shot session: count strokes/shots, apply win condition of 20 strokes/shots or under, require pocketing all balls with the 8-ball last (rules display + session completion), apply scratch penalty as +2 shots, and ensure the break shot does not count as a shot; explicitly handle and document the \"scratch on break\" case per the user note.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-update-persisted-straight-shot-match-data-builder-saved-match-payload-so-straight-shot-history-reflects-stroke-based-tracking-including-scratch-impact-instead-of-the-current-attempts-makes-accuracy-model",
      "title": "Update persisted Straight Shot match data (builder + saved match payload) so Straight Shot history reflects stroke-based tracking (including scratch impact) instead of the current attempts/makes accuracy model.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-add-moving-average-tracking-and-display-for-the-straight-shot-strokes-drill-based-on-saved-straight-shot-match-history-for-the-signed-in-user",
      "title": "Add moving average tracking and display for the Straight Shot strokes drill based on saved Straight Shot match history for the signed-in user.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-investigate-and-fix-the-regression-where-a-previously-authenticated-user-is-unexpectedly-logged-out-or-forced-to-re-authenticate-after-an-app-update-reload-so-that-internet-identity-sessions-persist-as-expected-across-page-reloads-and-routine-redeploys-until-the-delegation-expires-or-the-user-explicitly-logs-out",
      "title": "Investigate and fix the regression where a previously authenticated user is unexpectedly logged out (or forced to re-authenticate) after an app update/reload, so that Internet Identity sessions persist as expected across page reloads and routine redeploys (until the delegation expires or the user explicitly logs out).",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-remove-all-apa-practice-ui-logic-that-treats-apa-as-a-race-to-x-format-and-update-the-apa-practice-start-and-game-screens-to-be-apa-9-ball-equalizer-point-based-tracking-points-to-win-by-skill-level-rather-than-a-rack-race",
      "title": "Remove all APA Practice UI/logic that treats APA as a 'race to X' format, and update the APA Practice start and game screens to be APA 9-ball Equalizer point-based tracking (points-to-win by skill level) rather than a rack race.",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-apa-9-ball-rack-by-rack-scoring-capture-in-the-apa-practice-flow-including-10-total-points-per-rack-1-8-1-point-each-9-ball-2-points-dead-balls-tracked-as-0-points-and-defensive-shots-tracking-in-a-way-that-mirrors-core-apa-scorekeeper-behaviors-for-practice-use",
      "title": "Implement APA 9-ball rack-by-rack scoring capture in the APA Practice flow, including: 10 total points per rack (1–8 = 1 point each, 9-ball = 2 points), dead balls tracked as 0 points, and defensive shots tracking, in a way that mirrors core APA scorekeeper behaviors for practice use.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-at-the-end-of-an-apa-9-ball-practice-match-calculate-and-display-apa-20-point-match-result-conversion-winner-12-20-loser-0-8-using-the-user-provided-sl-specific-chart-thresholds-based-on-the-losing-player-s-ball-points-earned-relative-to-their-sl-goal",
      "title": "At the end of an APA 9-ball practice match, calculate and display APA 20-point match result conversion (winner 12–20 / loser 0–8) using the user-provided SL-specific chart thresholds based on the losing player’s ball points earned relative to their SL goal.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-update-persisted-match-data-structures-so-apa-practice-saved-matches-store-the-new-apa-9-ball-equalizer-fields-skill-levels-points-to-win-targets-per-rack-scoring-with-dead-balls-defensive-shots-innings-ppi-and-match-point-conversion-outcome-and-ensure-match-history-and-match-details-render-a-correct-apa-9-ball-summary-for-these-matches",
      "title": "Update persisted match data structures so APA Practice saved matches store the new APA 9-ball Equalizer fields (skill levels, points-to-win targets, per-rack scoring with dead balls, defensive shots, innings/PPI, and match-point conversion outcome) and ensure Match History and Match Details render a correct APA 9-ball summary for these matches.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-update-any-app-branding-elements-that-incorrectly-imply-8-ball-for-an-apa-9-ball-focused-scorekeeper-e-g-the-8-badge-in-the-header-login-card-while-keeping-all-user-facing-text-in-english",
      "title": "Update any app branding elements that incorrectly imply 8-ball for an APA 9-ball-focused scorekeeper (e.g., the '8' badge in the header/login card), while keeping all user-facing text in English.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-current-apa-rack-scoring-entry-ui-numeric-inputs-for-points-innings-with-a-seamless-per-inning-gui-for-apa-9-ball-practice-matches-show-balls-1-9-for-the-current-rack-allow-the-scorekeeper-to-tap-select-which-balls-were-pocketed-during-the-current-inning-and-provide-a-clear-turn-over-control-to-advance-to-the-next-player-s-inning",
      "title": "Replace the current APA rack scoring entry UI (numeric inputs for points/innings) with a seamless per-inning GUI for APA 9-ball practice matches: show balls 1–9 for the current rack, allow the scorekeeper to tap/select which balls were pocketed during the current inning, and provide a clear \"Turn Over\" control to advance to the next player's inning.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-automatic-innings-tracking-for-apa-practice-gameplay-based-on-the-per-inning-flow-innings-should-be-incremented-automatically-as-the-scorekeeper-uses-the-turn-over-workflow-no-manual-innings-numeric-input-fields",
      "title": "Implement automatic innings tracking for APA Practice gameplay based on the per-inning flow: innings should be incremented automatically as the scorekeeper uses the \"Turn Over\" workflow (no manual innings numeric input fields).",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-add-in-flow-controls-to-mark-dead-balls-and-defensive-shots-during-apa-per-inning-entry-without-breaking-the-existing-per-rack-10-point-accounting-and-defensive-shot-totals",
      "title": "Add in-flow controls to mark dead balls and defensive shots during APA per-inning entry, without breaking the existing per-rack 10-point accounting and defensive-shot totals.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-apa-practice-game-flow-to-compute-and-submit-the-existing-per-rack-summary-data-playera-playerb-points-dead-balls-innings-defensive-shots-from-the-new-per-inning-ball-based-ui-keeping-the-saved-match-record-shape-and-match-history-details-rendering-compatible-with-existing-apa-match-persistence",
      "title": "Update the APA Practice game flow to compute and submit the existing per-rack summary data (playerA/playerB points, dead balls, innings, defensive shots) from the new per-inning ball-based UI, keeping the saved match record shape and Match History/Details rendering compatible with existing APA match persistence.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-update-accepting-gifts-session-setup-to-support-a-configurable-starting-object-ball-count-defaulting-to-3-object-balls-plus-the-8-and-persist-this-setting-in-the-in-progress-session-state",
      "title": "Update Accepting Gifts session setup to support a configurable starting object-ball count, defaulting to 3 object balls (plus the 8), and persist this setting in the in-progress session state.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-accepting-gifts-rules-ui-copy-with-an-english-rules-description-that-matches-the-user-provided-rules-including-play-with-1-7-object-balls-of-one-group-plus-the-8-break-then-take-ball-in-hand-balls-made-on-break-are-spotted-reset-on-spots-goal-is-to-run-out-in-one-attempt-scoring-as-a-race-to-7-points-vs-a-ghost-next-set-increases-decreases-object-balls-based-on-set-win-loss-note-the-optional-blocking-ball-progression-after-winning-with-7-object-balls",
      "title": "Replace the Accepting Gifts rules UI copy with an English rules description that matches the user-provided rules, including: play with 1–7 object balls of one group plus the 8; break then take ball-in-hand; balls made on break are spotted (reset on spots); goal is to run out in one attempt; scoring as a race to 7 points vs a ghost; next set increases/decreases object balls based on set win/loss; note the optional blocking-ball progression after winning with 7 object balls.",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-accepting-gifts-gameplay-tracking-according-to-the-provided-ghost-opponent-set-rules-track-current-set-score-player-points-vs-ghost-points-to-7-represent-each-run-out-as-an-attempt-with-a-success-fail-outcome-award-1-point-to-the-player-on-success-or-to-the-ghost-on-failure-end-the-set-when-either-reaches-7-after-set-end-automatically-prepare-the-next-set-with-starting-object-balls-adjusted-1-on-set-win-1-on-set-loss-clamped-to-1-7-start-each-new-attempt-with-ball-in-hand-represented-in-ui-as-a-new-attempt",
      "title": "Implement Accepting Gifts gameplay tracking according to the provided “ghost opponent” set rules: track current set score (player points vs ghost points) to 7; represent each run-out as an attempt with a success/fail outcome; award 1 point to the player on success or to the ghost on failure; end the set when either reaches 7; after set end, automatically prepare the next set with starting object balls adjusted (+1 on set win, −1 on set loss), clamped to 1–7; start each new attempt with ball-in-hand (represented in UI as a new attempt).",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-extend-accepting-gifts-saved-match-data-to-include-the-new-rule-tracking-fields-at-minimum-starting-object-ball-count-ending-object-ball-count-or-current-count-at-session-end-total-attempts-number-of-sets-completed-and-final-set-score-player-vs-ghost-and-save-these-fields-when-ending-the-session",
      "title": "Extend Accepting Gifts saved match data to include the new rule-tracking fields (at minimum: starting object-ball count, ending object-ball count or current count at session end, total attempts, number of sets completed, and final set score Player vs Ghost) and save these fields when ending the session.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-update-match-history-summary-cards-and-match-details-rendering-for-accepting-gifts-to-show-the-new-key-summary-information-starting-object-balls-sets-completed-final-player-vs-ghost-score-attempts-in-english-while-keeping-existing-display-for-older-matches-that-lack-these-fields",
      "title": "Update Match History summary cards and Match Details rendering for Accepting Gifts to show the new key summary information (starting object balls, sets completed, final Player vs Ghost score, attempts) in English, while keeping existing display for older matches that lack these fields.",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-in-apa-9-ball-practice-rack-scoring-if-the-9-ball-is-recorded-as-pocketed-by-either-player-before-the-rack-is-otherwise-accounted-for-automatically-mark-all-remaining-unscored-balls-as-dead-so-that-the-rack-totals-reach-10-points-without-manual-dead-ball-entry",
      "title": "In APA 9-ball practice rack scoring, if the 9-ball is recorded as pocketed (by either player) before the rack is otherwise accounted for, automatically mark all remaining unscored balls as dead so that the rack totals reach 10 points without manual dead-ball entry.",
      "reqIds": [
        "REQ-27"
      ],
      "version": 1
    },
    {
      "id": "feature-persist-the-accepting-gifts-drill-progression-per-user-so-the-current-object-ball-count-and-optionally-the-in-progress-session-state-is-saved-server-side-and-automatically-restored-after-logout-login-page-reloads-or-starting-a-new-accepting-gifts-session",
      "title": "Persist the Accepting Gifts drill progression per user so the current object-ball count (and optionally the in-progress session state) is saved server-side and automatically restored after logout/login, page reloads, or starting a new Accepting Gifts session.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-enforce-a-minimum-object-ball-count-of-2-not-1-for-accepting-gifts-progression-and-inputs-and-update-all-related-ui-copy-to-reflect-the-2-7-range-in-english",
      "title": "Enforce a minimum object-ball count of 2 (not 1) for Accepting Gifts progression and inputs, and update all related UI copy to reflect the 2–7 range in English.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-user-controlled-reset-override-mechanism-for-accepting-gifts-so-the-user-can-explicitly-set-the-starting-current-object-ball-count-2-7-and-have-that-choice-persisted-as-the-new-carry-forward-baseline",
      "title": "Add a user-controlled reset/override mechanism for Accepting Gifts so the user can explicitly set the starting/current object-ball count (2–7) and have that choice persisted as the new carry-forward baseline.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-backend-api-support-for-accepting-gifts-carry-forward-state-and-in-progress-session-storage-tied-to-the-authenticated-principal-and-wire-it-into-the-existing-react-query-data-layer",
      "title": "Implement backend API support for Accepting Gifts carry-forward state and in-progress session storage tied to the authenticated principal, and wire it into the existing React Query data layer.",
      "reqIds": [
        "REQ-31"
      ],
      "version": 1
    },
    {
      "id": "feature-update-apa-9-ball-rack-scoring-so-that-once-the-9-ball-is-recorded-as-pocketed-by-either-player-the-rack-is-treated-as-over-automatically-mark-all-remaining-unscored-balls-1-8-as-dead-and-prevent-any-further-ball-scoring-dead-ball-changes-for-that-rack-except-allowing-the-user-to-undo-unmark-the-9-ball-to-correct-mistakes",
      "title": "Update APA 9-ball rack scoring so that once the 9-ball is recorded as pocketed by either player, the rack is treated as over: automatically mark all remaining unscored balls (1–8) as dead, and prevent any further ball scoring/dead-ball changes for that rack except allowing the user to undo/unmark the 9-ball to correct mistakes.",
      "reqIds": [
        "REQ-32"
      ],
      "version": 1
    },
    {
      "id": "feature-auto-remember-and-auto-fill-the-signed-in-user-s-primary-player-name-from-the-existing-caller-user-profile-when-starting-new-matches-so-the-user-does-not-need-to-retype-their-name-each-time",
      "title": "Auto-remember and auto-fill the signed-in user’s primary player name (from the existing caller user profile) when starting new matches, so the user does not need to retype their name each time.",
      "reqIds": [
        "REQ-33"
      ],
      "version": 1
    },
    {
      "id": "feature-provide-a-per-player-aggregate-stats-view-that-can-be-opened-for-any-player-name-that-appears-in-the-user-s-saved-matches-and-compute-the-stats-from-the-signed-in-user-s-match-history-data",
      "title": "Provide a per-player Aggregate Stats view that can be opened for any player name that appears in the user’s saved matches, and compute the stats from the signed-in user’s match history data.",
      "reqIds": [
        "REQ-34"
      ],
      "version": 1
    },
    {
      "id": "feature-on-the-aggregate-stats-page-add-apa-9-ball-charts-for-the-selected-player-1-ppi-by-match-with-a-rolling-line-for-best-10-of-last-20-with-the-user-specified-fallback-rules-and-2-match-by-match-results-plotted-with-the-same-rolling-line-overlaid",
      "title": "On the Aggregate Stats page, add APA 9-ball charts for the selected player: (1) PPI by match with a rolling line for “best 10 of last 20” (with the user-specified fallback rules), and (2) match-by-match results plotted with the same rolling line overlaid.",
      "reqIds": [
        "REQ-35"
      ],
      "version": 1
    },
    {
      "id": "feature-add-navigation-from-individual-match-details-to-the-per-player-aggregate-stats-page-for-each-listed-player-so-the-user-can-jump-from-an-individual-result-to-that-player-s-aggregate-graphs",
      "title": "Add navigation from individual match details to the per-player Aggregate Stats page for each listed player, so the user can jump from an individual result to that player’s aggregate graphs.",
      "reqIds": [
        "REQ-36"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-app-s-primary-player-concept-is-per-account-device-by-using-the-existing-internet-identity-caller-profile-as-the-source-of-truth-and-provide-an-easy-way-to-set-or-change-it-using-the-existing-profile-setup-flow",
      "title": "Ensure the app’s primary player concept is per account/device by using the existing Internet Identity caller profile as the source of truth, and provide an easy way to set or change it using the existing profile setup flow.",
      "reqIds": [
        "REQ-37"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-profile-setup-edit-profile-dialog-to-allow-viewing-and-editing-the-primary-player-s-apa-9-ball-skill-level-alongside-the-name-and-save-both-fields-to-the-user-profile-implement-this-in-frontend-src-components-auth-profilesetupdialog-tsx-by-adding-an-apa-skill-level-selector-using-the-existing-apa-skill-level-constants-utilities-from-frontend-src-lib-apa-apaequalizer-ts-user-facing-text-must-be-in-english-and-should-clearly-indicate-this-skill-level-is-used-as-the-default-for-apa-matches-e-g-label-like-apa-9-ball-skill-level-default",
      "title": "Update the Profile Setup / Edit Profile dialog to allow viewing and editing the primary player’s APA 9-ball skill level alongside the name, and save both fields to the user profile.\n\nImplement this in `frontend/src/components/auth/ProfileSetupDialog.tsx` by adding an APA skill level selector using the existing APA skill-level constants/utilities (from `frontend/src/lib/apa/apaEqualizer.ts`).\n\nUser-facing text must be in English and should clearly indicate this skill level is used as the default for APA matches (e.g., label like “APA 9-Ball Skill Level (Default)”).",
      "reqIds": [
        "REQ-39"
      ],
      "version": 1
    },
    {
      "id": "feature-auto-fill-the-saved-primary-player-apa-skill-level-when-starting-a-new-apa-practice-match-update-frontend-src-pages-apa-practicestartpage-tsx-so-that-when-the-signed-in-user-has-a-saved-profile-skill-level-the-apa-start-page-uses-it-as-the-default-selection-for-the-primary-player-instead-of-always-defaulting-to-sl-5-the-auto-fill-behavior-should-not-block-manual-overrides-if-the-user-changes-the-skill-level-in-the-start-form-it-must-respect-the-user-s-selection",
      "title": "Auto-fill the saved primary player APA skill level when starting a new APA practice match.\n\nUpdate `frontend/src/pages/apa/PracticeStartPage.tsx` so that when the signed-in user has a saved profile skill level, the APA start page uses it as the default selection for the primary player instead of always defaulting to SL 5.\n\nThe auto-fill behavior should not block manual overrides: if the user changes the skill level in the start form, it must respect the user’s selection.",
      "reqIds": [
        "REQ-40"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-apa-practice-start-page-so-the-signed-in-user-s-saved-apa-skill-level-auto-loads-into-whichever-player-slot-player-1-or-player-2-currently-matches-the-caller-s-saved-primary-player-name-case-insensitive-including-when-the-user-overwrites-edits-the-name-field-after-initial-entry",
      "title": "Update the APA Practice Start page so the signed-in user's saved APA skill level auto-loads into whichever player slot (Player 1 or Player 2) currently matches the caller's saved primary player name (case-insensitive), including when the user overwrites/edits the name field after initial entry.",
      "reqIds": [
        "REQ-41"
      ],
      "version": 1
    },
    {
      "id": "feature-add-validation-to-prevent-starting-an-apa-practice-match-when-player-1-and-player-2-names-are-the-same-person-case-insensitive-show-an-english-validation-message-and-keep-the-start-match-button-disabled-or-block-start-until-the-issue-is-corrected",
      "title": "Add validation to prevent starting an APA Practice match when Player 1 and Player 2 names are the same person (case-insensitive). Show an English validation message and keep the Start Match button disabled (or block start) until the issue is corrected.",
      "reqIds": [
        "REQ-42"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-apa-practice-start-page-skill-level-auto-load-logic-applies-symmetrically-to-both-slots-by-tracking-manual-override-state-per-slot-player-1-sl-touched-and-player-2-sl-touched-and-resetting-that-override-state-when-that-slot-s-name-changes",
      "title": "Ensure APA Practice Start page skill level auto-load logic applies symmetrically to both slots by tracking \"manual override\" state per slot (Player 1 SL touched and Player 2 SL touched), and resetting that override state when that slot's name changes.",
      "reqIds": [
        "REQ-43"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-an-invite-only-access-control-mode-for-the-app-using-an-allowlist-of-approved-internet-identity-principals-so-the-app-owner-can-approve-teammates-while-blocking-everyone-else-even-if-the-app-link-is-shared",
      "title": "Implement an invite-only access control mode for the app using an allowlist of approved Internet Identity principals, so the app owner can approve teammates while blocking everyone else even if the app link is shared.",
      "reqIds": [
        "REQ-44"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-owner-approval-ui-screen-where-the-app-owner-can-review-pending-access-requests-and-approve-or-reject-them-individually-plus-a-one-click-reject-all-pending-action",
      "title": "Add an Owner Approval UI screen where the app owner can review pending access requests and approve or reject them individually, plus a one-click \"Reject All Pending\" action.",
      "reqIds": [
        "REQ-46"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-authentication-gate-so-that-after-internet-identity-login-users-who-are-not-approved-while-invite-only-mode-is-enabled-see-a-clear-english-access-denied-experience-instead-of-generic-failures-and-the-owner-can-still-access-the-admin-approval-tools",
      "title": "Update the authentication gate so that after Internet Identity login, users who are not approved (while invite-only mode is enabled) see a clear English access-denied experience instead of generic failures, and the owner can still access the admin approval tools.",
      "reqIds": [
        "REQ-47"
      ],
      "version": 1
    },
    {
      "id": "feature-provide-an-owner-only-control-to-disable-invite-only-mode-later-switch-back-to-public-access-reflecting-the-user-s-intent-to-potentially-remove-the-approval-requirement-in-the-future",
      "title": "Provide an owner-only control to disable invite-only mode later (switch back to public access), reflecting the user’s intent to potentially remove the approval requirement in the future.",
      "reqIds": [
        "REQ-48"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-access-check-loading-deadlock-by-ensuring-the-frontend-can-always-determine-access-state-or-safely-bypass-it-in-public-mode-without-getting-stuck-on-checking-access",
      "title": "Fix the access-check loading deadlock by ensuring the frontend can always determine access state (or safely bypass it in public mode) without getting stuck on \"Checking access...\".",
      "reqIds": [
        "REQ-50"
      ],
      "version": 1
    },
    {
      "id": "feature-when-public-no-approval-mode-is-active-do-not-show-the-invite-only-access-not-allowed-experience-or-approval-request-cta-as-part-of-the-normal-login-flow",
      "title": "When public/no-approval mode is active, do not show the invite-only \"Access Not Allowed\" experience or approval-request CTA as part of the normal login flow.",
      "reqIds": [
        "REQ-52"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-4th-mode-tile-card-to-the-home-screen-mode-grid-that-navigates-to-a-new-placeholder-route-for-a-future-real-apa-match-logging-mode",
      "title": "Add a 4th mode tile/card to the Home screen mode grid that navigates to a new placeholder route for a future “real APA match logging” mode.",
      "reqIds": [
        "REQ-53"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-new-blank-placeholder-page-component-for-the-4th-mode-and-register-a-new-tanstack-router-route-for-it-in-the-app-router",
      "title": "Create a new blank placeholder page component for the 4th mode and register a new TanStack Router route for it in the app router.",
      "reqIds": [
        "REQ-54"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-current-coming-soon-placeholder-content-on-frontend-src-pages-apa-realapamatchplaceholderpage-tsx-with-an-on-page-after-the-fact-match-logging-form-that-includes-the-following-fields-match-date-opponent-name-your-score-their-score-points-innings-defensive-shots-and-notes-all-user-facing-text-must-be-in-english",
      "title": "Replace the current \"Coming Soon\" placeholder content on `frontend/src/pages/apa/RealApaMatchPlaceholderPage.tsx` with an on-page, after-the-fact match logging form that includes the following fields: match date, opponent name, your score, their score, points, innings, defensive shots, and notes. All user-facing text must be in English.",
      "reqIds": [
        "REQ-55"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-local-in-component-state-handling-for-the-official-apa-match-log-form-fields-on-frontend-src-pages-apa-realapamatchplaceholderpage-tsx-so-the-user-can-type-values-and-see-them-preserved-while-staying-on-the-page-without-adding-any-backend-persistence-or-saving-yet",
      "title": "Implement local (in-component) state handling for the Official APA Match Log form fields on `frontend/src/pages/apa/RealApaMatchPlaceholderPage.tsx` so the user can type values and see them preserved while staying on the page, without adding any backend persistence or saving yet.",
      "reqIds": [
        "REQ-56"
      ],
      "version": 1
    },
    {
      "id": "feature-add-basic-client-side-validation-ux-for-the-official-apa-match-log-form-ensure-numeric-fields-accept-only-numeric-input-and-show-an-english-inline-validation-message-for-obviously-invalid-values-e-g-negative-numbers-validation-must-not-require-backend-calls",
      "title": "Add basic client-side validation UX for the Official APA Match Log form: ensure numeric fields accept only numeric input and show an English inline validation message for obviously invalid values (e.g., negative numbers). Validation must not require backend calls.",
      "reqIds": [
        "REQ-57"
      ],
      "version": 1
    },
    {
      "id": "feature-on-frontend-src-pages-apa-realapamatchplaceholderpage-tsx-add-a-prominent-placeholder-save-button-for-the-official-apa-match-log-form-without-implementing-any-backend-persistence-yet",
      "title": "On `frontend/src/pages/apa/RealApaMatchPlaceholderPage.tsx`, add a prominent placeholder \"Save\" button for the Official APA Match Log form, without implementing any backend persistence yet.",
      "reqIds": [
        "REQ-58"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-placeholder-save-behavior-on-frontend-src-pages-apa-realapamatchplaceholderpage-tsx-so-that-clicking-save-match-persists-the-form-data-as-an-official-real-apa-match-log-using-the-existing-react-query-mutation-patterns",
      "title": "Replace the placeholder Save behavior on frontend/src/pages/apa/RealApaMatchPlaceholderPage.tsx so that clicking “Save Match” persists the form data as an Official/Real APA match log, using the existing React Query mutation patterns.",
      "reqIds": [
        "REQ-61"
      ],
      "version": 1
    },
    {
      "id": "feature-update-match-history-and-match-details-ui-to-recognize-and-correctly-render-the-new-official-real-apa-match-log-mode-including-labels-and-a-compact-summary",
      "title": "Update Match History and Match Details UI to recognize and correctly render the new Official/Real APA match log mode, including labels and a compact summary.",
      "reqIds": [
        "REQ-62"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-routing-navigation-remains-consistent-after-saving-an-official-real-apa-match-log-entry-so-users-can-find-it-in-history-and-open-its-details-reliably",
      "title": "Ensure routing/navigation remains consistent after saving an Official/Real APA match log entry so users can find it in history and open its details reliably.",
      "reqIds": [
        "REQ-63"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-official-apa-match-log-page-frontend-src-pages-apa-realapamatchplaceholderpage-tsx-save-button-to-persist-the-current-form-inputs-via-the-existing-react-query-save-mutation-usesavematch-by-constructing-a-matchlogrecord-for-the-official-real-apa-match-log-type-and-submitting-it-to-the-backend",
      "title": "Wire the Official APA Match Log page (`frontend/src/pages/apa/RealApaMatchPlaceholderPage.tsx`) Save button to persist the current form inputs via the existing React Query save mutation (`useSaveMatch`) by constructing a MatchLogRecord for the Official/Real APA match log type and submitting it to the backend.",
      "reqIds": [
        "REQ-65"
      ],
      "version": 1
    },
    {
      "id": "feature-update-match-history-and-match-details-ui-to-recognize-and-render-official-real-apa-match-log-entries-saved-from-the-official-apa-match-log-form-showing-a-compact-english-summary-in-history-and-the-full-set-of-saved-fields-in-details",
      "title": "Update Match History and Match Details UI to recognize and render Official/Real APA match log entries saved from the Official APA Match Log form, showing a compact English summary in history and the full set of saved fields in details.",
      "reqIds": [
        "REQ-66"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Create an APA-style pool scorekeeper app to track practice games similar to the official APA Scorekeeper app.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Add an additional scoring/match-tracking mode for the 'Accepting Gifts' pool game.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Add an additional scoring/match-tracking mode for the 'Straight Shot' pool game.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Implement backend persistence for practice games and match history, supporting all three modes with a unified data model that stores: mode, date/time, players (names), optional notes, and a mode-specific scoring payload.",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Update Straight Shot (drill) mode rules and tracking: count strokes with win condition <=20; pocket all balls with 8-ball last; scratches add +2 shots (break shot doesn’t count; clarify scratch-on-break handling); track and display moving average of strokes over time; ensure naming/description doesn’t imply 'straight pool'.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Correct APA mode to be APA 9-ball Equalizer scoring (points-to-win by skill level), including per-rack 10-point accounting (balls + dead balls), defensive shots, innings, PPI calculation, and 20-point match-point conversion (12–20 winner / 0–8 loser). Remove any 'race to X' UI/logic.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Improve APA 9-ball scoring UI to a seamless, APA-scorekeeper-like per-inning GUI: display balls 1–9 each rack, allow selecting pocketed balls per inning, provide a Turn Over button to alternate turns, auto-adjust innings, and support marking dead balls and defensive shots during entry.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Accepting Gifts: persist and carry forward the current object-ball count across sessions (including mid-session resume) so new sessions default to where the user left off; allow user to optionally reset/override the starting ball count; enforce minimum of 2 balls.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Add primary player profile selection (per device/account) to auto-remember the main user name and auto-fill it in new matches; support optional opponent name persistence.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Add aggregated player stats and graphs in Results: per-player aggregate view with (1) PPI trend line plus rolling best-10-of-last-20 average line; (2) match-by-match results plotted with rolling best-10-of-last-20 average line; include a button from individual match results to the aggregate player view.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Persist and auto-fill the Primary Player’s APA skill level (SL) from the user profile so new APA matches automatically load the saved SL instead of requiring re-entry each match.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Extend the backend user profile to store the primary player’s APA 9-ball skill level, and return/save it via the existing profile APIs.\n\nContext: backend/main.mo currently defines `public type UserProfile = { name : Text; };` and profile is saved via `saveCallerUserProfile` / fetched via `getCallerUserProfile`.\n\nAdd a new optional field (e.g., `apaSkillLevel : ?Nat`) so existing users who only have a name saved remain valid.",
      "reqIds": [
        "REQ-38"
      ],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "APA match setup: prevent using the Primary Player (main profile name) in both Player 1 and Player 2 (no playing yourself); block match start or show validation error if duplicated, and ensure the Primary Player’s saved APA skill level auto-loads into whichever slot (P1 or P2) contains that name; if the user manually edits SL for the match, respect the override but re-auto-load when the name field changes to/from the Primary Player.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Add optional invite-only access control using an allowlist of approved Internet Identity principals; non-approved users see an 'Access not allowed' screen; support switching back to public access later.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Add an Owner Approval admin screen linked to the app owner's identity: capture login attempts into a pending list, allow Approve/Reject per principal, and include a one-click 'Reject All Pending' action for spam bursts.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "Add backend support to record and manage access requests: when a non-approved signed-in principal attempts to use the app, capture them into a pending requests list that the owner can review.",
      "reqIds": [
        "REQ-45"
      ],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Add a discrete 4th mode for logging real APA 9-ball matches (not drills): manual match entry including date/opponent/notes and key stats (points, innings, defensive shots, etc.), and display charts for both actual PPI and adjusted PPI, each with a rolling “best 10 of last 20” line.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-20",
      "summary": "Provide a way to run the app in a working public/no-approval mode by disabling or bypassing the invite-only approval/login gate (at least temporarily), since the access-check loading flow can get stuck; keep the option to re-enable invite-only later.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-21",
      "summary": "Make the app usable without any invite-only approval flow (public mode) by default, while keeping the ability for an admin to re-enable invite-only later.",
      "reqIds": [
        "REQ-49"
      ],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "Update backend access-control query behavior so non-admin users do not trigger authorization traps during normal app startup checks (especially for invite-only mode state).",
      "reqIds": [
        "REQ-51"
      ],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "Implement the first incremental step of the discrete 4th mode (real APA match logging): add a 4th mode tile on the home screen that navigates to a blank placeholder page/screen (no form fields yet).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "4th mode (real APA match logging): add basic after-the-fact match entry form fields on the placeholder page (e.g., date, opponent, your/their points or score, innings, defensive shots, notes).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Add a Save button and persistence for the Official/Real APA match log form so entered matches can be stored (beyond in-component state).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-27",
      "summary": "Add backend persistence for the Official/Real APA Match Log entries as a first-class match type that can be saved, listed, fetched, and deleted using the existing match history storage patterns.",
      "reqIds": [
        "REQ-59"
      ],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Update the backend API match projection so Official/Real APA match logs are represented in the returned ApiMatch shape with all fields needed for Match History summary cards and Match Details rendering.",
      "reqIds": [
        "REQ-60"
      ],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Add backend persistence support for an Official/Real APA match log record type so the app can save exactly the user-entered fields from the Official APA Match Log form (match date, opponent name, your score, their score, points, innings, defensive shots, notes) using the existing match storage APIs (save, list, fetch, delete) and the existing match-history storage pattern.",
      "reqIds": [
        "REQ-64"
      ],
      "status": "pending"
    }
  ],
  "projectName": "APA-style pool practice scorekeeper with Accepting Gifts and Straight Shot modes",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}