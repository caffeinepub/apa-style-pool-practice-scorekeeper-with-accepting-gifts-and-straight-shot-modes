{
  "kind": "build_request",
  "title": "Fix React error #185 infinite render loop with useCallback",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "In frontend/src/pages/apa/PracticeGamePage.tsx, add useCallback to the React imports from 'react'",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-19"
        ],
        "quotes": [
          "import { useState, useEffect, useCallback } from 'react';"
        ]
      },
      "acceptanceCriteria": [
        "The import statement includes useCallback alongside useState and useEffect"
      ]
    },
    {
      "id": "REQ-2",
      "text": "In frontend/src/pages/apa/PracticeGamePage.tsx, wrap the handleLiveRackUpdate function with useCallback and [session] as the dependency array. Keep the function body exactly the same - only add the useCallback wrapper around it.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-19"
        ],
        "quotes": [
          "const handleLiveRackUpdate = useCallback(\n  (data: { player1Points: number; player2Points: number }) => {\n    if (!session) return;\n\n    let originalPlayer1LivePoints: number;\n    let originalPlayer2LivePoints: number;\n\n    if (session.lagWinner === 'A') {\n      originalPlayer1LivePoints = data.player1Points;\n      originalPlayer2LivePoints = data.player2Points;\n    } else {\n      originalPlayer1LivePoints = data.player2Points;\n      originalPlayer2LivePoints = data.player1Points;\n    }\n\n    setLiveRackPoints({\n      player1: originalPlayer1LivePoints,\n      player2: originalPlayer2LivePoints,\n    });\n  },\n  [session]\n);"
        ]
      },
      "acceptanceCriteria": [
        "handleLiveRackUpdate is wrapped with useCallback",
        "The dependency array contains [session]",
        "The function body logic remains completely unchanged",
        "The function still performs lag winner remapping and calls setLiveRackPoints"
      ]
    }
  ],
  "constraints": [
    "Do not modify any files other than frontend/src/pages/apa/PracticeGamePage.tsx",
    "Do not change the function body of handleLiveRackUpdate - only add the useCallback wrapper",
    "Do not modify any scoring logic, innings tracking, or turn flow",
    "Do not remove any debug logging (dlog calls)",
    "Do not touch ApaRackScoringPanel.tsx or any other component files",
    "Preserve all existing game rules and session management logic"
  ],
  "nonGoals": [
    "Fixing the auto-dead ball revert issue (separate bug)",
    "Adding new features or changing game rules",
    "Modifying the backend or access management",
    "Changing any other components or pages"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}